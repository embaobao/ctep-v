<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Ë¥¶Êà∑ÁÆ°ÁêÜ|EMBËØæÂ†ÇÊïôÂ≠¶ËØÑ‰ª∑ÁÆ°ÁêÜÂπ≥Âè∞|</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta http-equiv="refresh" content="">
    <meta name="keywords" content="ËØÑ‰ª∑,ËØæÂ†Ç,ÊïôÂ≠¶ËØÑ‰ª∑,Ê≥®ÂÜå,ÁÆ°ÁêÜÂπ≥Âè∞" />
    <meta name="description" content="ËØæÂ†ÇÊïôÂ≠¶ËØÑ‰ª∑ÁÆ°ÁêÜÂπ≥Âè∞" />
    <meta http-equiv="Pragma" content="no-cache">
    <!--ËÆæÁΩÆËØ•Êù°Â±ûÊÄßÔºåËÆøÈóÆËÄÖÂ∞ÜÊó†Ê≥ïËÑ±Êú∫ÊµèËßà„ÄÇ-->
    <meta http-equiv="refresh" content="" />
    <meta name="viewport" content="width=device-width,
        	initial-scale=1.0,
        	maximum-scale=1.0, 
        	user-scalable=no , 
        	shrink-to-fit=no" />
    <link rel="shortcut icon" href="images/ico/TEico.png">
    <link rel="stylesheet" href="css/jquery-ui.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">

    <meta name="author" content="EMB|ÂêÉÁÅ´ÊòüÁöÑÂÆùÂÆù " />
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

</head>
<style>
    @media screen and (max-width: 330px) {
        .card {
            background: transparent;
            padding: 0.8em;
            margin: 1.4em auto;
            width: 18em;
        }

        #tranLog {
            position: relative;
            left: 16em;
            width: 32px;
            padding: 2px;
        }

        .input-group {
            margin: 0.8em auto;
            padding: 0.4em;
        }
    }

    @media screen and (min-width: 331px) {
        .card {
            background: transparent;
            padding: 0.8em;
            margin: 2.6em auto;
            width: 22em;
        }

        #tranLog {
            position: relative;
            left: 20em;
            width: 32px;
            padding: 2px;
        }

        .input-group {
            margin: 1.6em auto;
            padding: 0.4em;
        }
    }

    .container-fluid {
        position: fixed;
        top: 0;
    }

    .card-body {
        background: white;
    }

    .card-footer,
    .card-header {
        background: transparent;
        text-align: center;
    }

    #loginbtg {
        display: none;
    }
</style>

<body>
    <div class="container-fluid ">
        <div class="row">
            <div class="col-sm-0 col-md-2 ">

            </div>
            <div class="col-sm-12 col-md-8  ">

                <div class="card rounded-0">
                    <button id="tranLog" class="btn btn-sm btn-outline-light">
                        <img src="images/app/transfer.png" width="24px" height="24px" data-toggle="tooltip"
                            data-placement="top" title="O_O Ë¶ÅÁôªÂΩï,ËøòË¶ÅÊ≥®ÂÜåÔºüÈöèÊÇ®ÊÑè!" />
                    </button>

                    <img data-toggle="tooltip" data-placement="right" title="( ‡∞†‡µ†‡∞† )ÂìºÂìº " src="images/app/user.png"
                        alt="John Doe" class="mx-auto" style="width:4em;">
                    <!-- align-self-center mx-auto -->

                    <div class="card-header">
                        <h5 id="titleTxt"> EMB-Ë¥¶Êà∑Ê≥®ÂÜå</h5>
                    </div>

                    <div class="card-body ">


                        <!-- <form> -->


                        <div class="input-group mb-3 ">
                            <div class="input-group-prepend ">
                                <span class="input-group-text rounded-0" data-toggle="tooltip" data-placement="left"
                                    title="ÈáèÂäõËÄåË°å üòéÈÄâÊã©Ë¥¶Êà∑ÁöÑËßíËâ≤!">
                                    <img src="images/app/role.png" width="24px" height="24px" /></span>
                            </div>
                            <select id="role" class="form-control rounded-0">
                                <option value="0">Â≠¶Áîü</option>
                                <option value="1">ÊïôÂ∏à</option>
                                <option value="2">ÁÆ°ÁêÜÂëò</option>
                            </select>
                        </div>

                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text rounded-0" data-toggle="tooltip" data-placement="left"
                                    title=" ^_^ ÊÇ®ÁöÑÈÇÆÁÆ±!">
                                    <img id="emailico" src="images/app/email.png" width="24px" height="24px" />
                                </span>
                            </div>
                            <input id="email" type="email" class="form-control rounded-0" placeholder="ÂëäËØâÊàëÊÇ®ÈÇÆÁÆ±Ë¥¶Êà∑Âì¶ü§£^_^">

                        </div>

                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text rounded-0" data-toggle="tooltip" data-placement="left"
                                    title="üòëÊÇ®ÁöÑÂØÜÁ†Å!">
                                    <img id="pwico" src="images/app/lock.png" width="24px" height="24px" />
                                </span>
                            </div>
                            <input id="password" type="password" class="form-control rounded-0"
                                placeholder="ÂÅ∑ÂÅ∑ÂëäËØâÊàëÊÇ®ÁöÑÁßòÁ†Åüò≥^_^">

                        </div>

                        <div id="regesterbtg" class="input-group mb-3 ">

                            <button id="regester" class="btn btn-outline-light mx-auto btn-block">
                                <img data-toggle="tooltip" data-placement="bottom" title="Âä†ÂÖ•Êàë‰ª¨!"
                                    src="images/app/register.png" width="32px" height="32px" />Ê≥®ÂÜå
                            </button>
                        </div>

                        <div id="loginbtg" class="input-group mb-3 ">
                            <button id="login" class="btn btn-outline-light mx-auto btn-block">
                                <img data-toggle="tooltip" data-placement="bottom" title="ËøõÂùë‚ÄîË∞¢Ë∞¢!"
                                    src="images/app/login.png" width="32px" height="32px" />ÁôªÂΩï
                            </button>
                        </div>
                        <!-- </form> -->

                    </div>

                    <div class="card-footer" style=" background: white;">
                        <p><small>EMBËØæÂ†ÇÊïôÂ≠¶ËØÑ‰ª∑ÁÆ°ÁêÜÂπ≥Âè∞</small>
                            <a href="#" data-toggle="tooltip" data-placement="bottom" title="(‡∏á ‚Ä¢_‚Ä¢)‡∏áÂøòËÆ∞ÂØÜÁ†ÅÁÇπÊàëÂì¶!"><img
                                    src="images/app/findpw.png" width="28px" height="28px" /></a>
                        </p>


                    </div>
                </div>




            </div>
            <div class="col-sm-0 col-md-2 ">
            </div>


            <!-- ---------------- -->
        </div>
    </div>
    <script src="js/base64.js"></script>
    <script src="js/cookie.js"></script>
    <script>
        $(document).ready(function () {
            var page = 0;
            var isMail = false;
            var LoginBt = $("#login");
            var RegesterBt = $("#regester");
            var emialTxt = $("#email");
            var pwTxt = $("#password");
            var roleVal = $("#role");
            var emilIco = $("#emailico");
            var pwIco = $("#pwico");
            var BaseUrl = "http://localhost:55810/User/";
            var user = {
                id: -1,
                email: '',
                role: 0,
                pw: ''
            };


            function changeIco(e, img) {
                e.attr("src", "images/app/" + img + ".png");
            }



            //                 changeIco(emilIco,"Lock-Mail");
            //                 changeIco(pwIco,"Lock-Screen")
            // 


            roleVal.bind("input propertychange", function (event) {
                user.role = roleVal.val();
                console.log("ËßíËâ≤ËÆæÂÆö:" + user.role);
            });



            $('[data-toggle="tooltip"]').tooltip();
            // $("#loginbtg").hide();
            var autoData = [];
            emialTxt.bind("input propertychange", function (event) {
                if (emialTxt.val().toString().indexOf("@") < 0) {
                    autoData.push(emialTxt.val() + "@qq.com");
                    autoData.push(emialTxt.val() + "@163.com");
                    autoData.push(emialTxt.val() + "@126.com");
                    autoData.push(emialTxt.val() + "@gmail.com");
                    autoData.push(emialTxt.val() + "@outlook.com");
                }
                if (emialTxt.val().trim().length < 1) {
                    changeIco(emilIco, "email");
                }


            });
            emialTxt.change(function () {
                user.email = emialTxt.val();
                console.log("Áî®Êà∑ÈÇÆÁÆ±ËÆæÂÆö:" + user.email);
                $.post(BaseUrl + "IsMail", { email: user.email },
                    function (data, status) {
                        if (status == "success") {
                            console.log(page);
                            isMail = data
                            if (isMail) {

                                if (page == 0) {
                                    changeIco(emilIco, "erro");
                                } else {
                                    changeIco(emilIco, "true");
                                }
                            }
                            else {
                                if (page == 0) {
                                    changeIco(emilIco, "true");
                                } else {
                                    changeIco(emilIco, "erro");
                                }

                            }
                        }
                        else {
                            changeIco(emilIco, "email");
                        }

                        console.log(data);

                    });
            })

            pwTxt.bind("input propertychange", function () {
                user.pw = pwTxt.val();
                console.log("Áî®Êà∑ÂØÜÁ†ÅËÆæÂÆö:" + user.pw);

            })

            emialTxt.autocomplete({
                source: autoData,
                change: function (event, ui) {
                    autoData = [];
                },
                select: function (event, ui) {
                    autoData = [];
                }


            });



            function transfer() {
                var logbtg = $("#loginbtg");
                var regesbtg = $("#regesterbtg");
                var titleTxt = $("#titleTxt");
                if (logbtg.css("display") == "none") {
                    regesbtg.animate({
                        // opacity: 'toggle',
                    });
                    page = 1;

                    titleTxt.text("EMB-Áî®Êà∑ÁôªÂΩï");
                    regesbtg.hide();
                    // regesbtg.css("display","none");
                    logbtg.show();
                } else {
                    logbtg.animate({
                        // opacity: 'toggle',
                    });
                    page = 0;
                    titleTxt.text("EMB-Áî®Êà∑Ê≥®ÂÜå");
                    logbtg.hide();
                    // logbtg.css("display","none");
                    regesbtg.show();
                }
            }


            $("#tranLog").click(function () {
                transfer();
            });



            RegesterBt.click(function () {
                user.email = emialTxt.val();
                user.role = roleVal.val();
                user.pw = pwTxt.val();


                try {

                    $.post(BaseUrl + "Register", user,
                    function (data, status) {
                        if (data) {
                            console.log("ok");
                            pushCookie(user);
                            // window.location.href="index.html";  
                        }
                        // alert("Êï∞ÊçÆ: \n" + data + "\nÁä∂ÊÄÅ: " + status);
                        console.log(data);
                    });

                } catch (error) {
                    
                }

             
            });



            LoginBt.click(function () {
                console.log("ÂºÄÂßãÁôªÈôÜ");
                user.email = emialTxt.val();
                user.role = roleVal.val();
                user.pw = pwTxt.val();
                try{
                    $.post(BaseUrl + "Login", user,
                    function (data, status) {
                        if (status == "success") {
                            if (data.id > 0) {
                                console.log("ok");
                                pushCookie(data);
                                window.location.href = "index.html";
                            }

                        }
                        console.log(data);
                    });
                }catch(erro){
                   
                }
            

               
            });






            // console.log(BCode.encode(JSON.stringify(user)));

            //                 ChckUserForCookie();


            // -----------------!

        });
    </script>


</body>

</html>